@using Hospital_Management.Data
@using Microsoft.EntityFrameworkCore
@inject ApplicationDbContext DbContext

@{
    ViewData["Title"] = "Dashboard";

    var totalPatients = await DbContext.Patients.CountAsync();
    var totalDentists = await DbContext.Dentists.CountAsync();
    var totalIncome = await DbContext.Appointments.SumAsync(x => x.Income);
    var totalAppointments = await DbContext.Appointments.CountAsync();
    var totalMedicinePayment = await DbContext.MedicinePayments.SumAsync(x => x.PricePaid);

    // Registered a month ago.
    var totalNewPatients = await DbContext.Patients.Where(x => x.RegisterDate.Month == DateTime.Now.Month).CountAsync();
    var totalPastaPatients = await DbContext.Patients.CountAsync(x => x.IsPasta ?? false);
    var totalBracedPatients = await DbContext.Patients.CountAsync(x => x.IsBraced ?? false);
    var totalToothExtractPatients = await DbContext.Patients.CountAsync(x => x.IsToothExtract ?? false);
    var totalExtractedTeeth = await DbContext.Patients.SumAsync(x => x.ToothExtracted ?? 0);
}

<div class="container row">
    <div class="row">
        <div class="rounded-3 shadow bg-info row container text-light">
            <div class="row container">
                <h2 class="m-2">Dashboard</h2>
            </div>
            <div class="row container m-2 ">
                <p>
                    <strong class="">Total Overall Stats</strong>
                </p>
            </div>
            <div class="d-flex align-content-start flex-wrap ">
                <div class="p-2">
                    <i class="bi bi-people-fill me-2"></i> @totalPatients Total Patients
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M14.84,16.26C17.86,16.83 20,18.29 20,20V22H4V20C4,18.29 6.14,16.83 9.16,16.26L12,21L14.84,16.26M8,8H16V10A4,4 0 0,1 12,14A4,4 0 0,1 8,10V8M8,7L8.41,2.9C8.46,2.39 8.89,2 9.41,2H14.6C15.11,2 15.54,2.39 15.59,2.9L16,7H8M12,3H11V4H10V5H11V6H12V5H13V4H12V3Z"/>
                    </svg> @totalDentists Total Dentists
                </div>
                <div class="p-2">
                    <i class="bi bi-cash-coin me-2"></i> @totalIncome Total Income
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M16.5 17.25L19.36 18.94L18.61 20.16L15 18V13H16.5V17.25M23 17C23 20.87 19.87 24 16 24C14.09 24 12.37 23.24 11.11 22H6C4.89 22 4 21.11 4 20V4C4 2.9 4.89 2 6 2H7V9L9.5 7.5L12 9V2H18C19.1 2 20 2.89 20 4V11.26C21.81 12.53 23 14.62 23 17M21 17C21 14.24 18.76 12 16 12S11 14.24 11 17 13.24 22 16 22 21 19.76 21 17Z"/>
                    </svg> @totalAppointments Total Appointments
                </div>
                <div class="p-2">
                    <i class="bi bi-capsule me-2"></i> @totalMedicinePayment Total Medicine Payments
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M8 6C8 3.79 9.79 2 12 2S16 3.79 16 6 14.21 10 12 10 8 8.21 8 6M17 22H18C19.1 22 20 21.1 20 20V15.22C20 14.1 19.39 13.07 18.39 12.56C17.96 12.34 17.5 12.13 17 11.94V22M12.34 17L15 11.33C14.07 11.12 13.07 11 12 11C9.47 11 7.29 11.7 5.61 12.56C4.61 13.07 4 14.1 4 15.22V22H6.34C6.12 21.55 6 21.04 6 20.5C6 18.57 7.57 17 9.5 17H12.34M10 22L11.41 19H9.5C8.67 19 8 19.67 8 20.5S8.67 22 9.5 22H10Z"/>
                    </svg> @totalNewPatients Total Medicine Payments
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M7,2C4,2 2,5 2,8C2,10.11 3,13 4,14C5,15 6,22 8,22C12.54,22 10,15 12,15C14,15 11.46,22 16,22C18,22 19,15 20,14C21,13 22,10.11 22,8C22,5 20,2 17,2C14,2 14,3 12,3C10,3 10,2 7,2Z"/>
                    </svg> @totalPastaPatients Total Pasta Patients
                </div>
                <div class="p-2">
                    <i class="bi bi-link me-2"></i> @totalBracedPatients Total Pasta Patients
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M12 10C14.21 10 16 8.21 16 6S14.21 2 12 2 8 3.79 8 6 9.79 10 12 10M12 4C13.1 4 14 4.9 14 6S13.1 8 12 8 10 7.1 10 6 10.9 4 12 4M18.39 12.56C16.71 11.7 14.53 11 12 11S7.29 11.7 5.61 12.56C4.61 13.07 4 14.1 4 15.22V22H6V15.22C6 14.84 6.2 14.5 6.5 14.34C7.71 13.73 9.63 13 12 13C12.76 13 13.47 13.07 14.13 13.2L12.58 16.5H9.75C8.23 16.5 7 17.73 7 19.25S8.23 22 9.75 22H18C19.1 22 20 21.1 20 20V15.22C20 14.1 19.39 13.07 18.39 12.56M10.94 20H9.75C9.34 20 9 19.66 9 19.25S9.34 18.5 9.75 18.5H11.64L10.94 20M18 20H13.15L16.09 13.73C16.63 13.93 17.1 14.14 17.5 14.34C17.8 14.5 18 14.84 18 15.22V20Z"/>
                    </svg> @totalToothExtractPatients Total Tooth Extracted Patients
                </div>
                <div class="p-2">
                    <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M7,2C4,2 2,5 2,8C2,10.11 3,13 4,14C5,15 6,22 8,22C12.54,22 10,15 12,15C14,15 11.46,22 16,22C18,22 19,15 20,14C21,13 22,10.11 22,8C22,5 20,2 17,2C14,2 14,3 12,3C10,3 10,2 7,2M7,4C9,4 10,5 12,5C14,5 15,4 17,4C18.67,4 20,6 20,8C20,9.75 19.14,12.11 18.19,13.06C17.33,13.92 16.06,19.94 15.5,19.94C15.29,19.94 15,18.88 15,17.59C15,15.55 14.43,13 12,13C9.57,13 9,15.55 9,17.59C9,18.88 8.71,19.94 8.5,19.94C7.94,19.94 6.67,13.92 5.81,13.06C4.86,12.11 4,9.75 4,8C4,6 5.33,4 7,4Z"/>
                    </svg> @totalExtractedTeeth Total Extracted Teeth
                </div>
            </div>
        </div>
    </div>
</div>